# 0908 TIL

## 1. B16234 인구이동

    import sys
    input = sys.stdin.readline
    sys.setrecursionlimit(10**6)
    
    def bfs(y, x):
        global S
        global V
        visited[y][x] = 1
        Q = []
        Q.append([y, x])
        T = arr[y][x]
        C = []
        C.append([y, x])
        while Q:
            yx = Q.pop()
            for k in range(4):
                ny = yx[0] + dy[k]
                nx = yx[1] + dx[k]
                if 0 <= ny < N and 0 <= nx < N and L <= abs(arr[ny][nx]-arr[yx[0]][yx[1]]) <= R and visited[ny][nx] == 0:
                    Q.append([ny, nx])
                    C.append([ny, nx])
                    T += arr[ny][nx]
                    visited[ny][nx] = 1
        if len(C) > 1:
            S = True
            t = T // len(C)
            C.append(t)
            V.append(C)
            print(C)
        else:
            C.append(arr[y][x])
            V.append(C)
            print(C)
    N, L, R = map(int, input().split())
    arr = [list(map(int, input().split())) for _ in range(N)]
    dx = [0, 1, 0, -1]
    dy = [-1, 0, 1, 0]
    result = -1
    V = []
    S = True
    while S:
        result += 1
        S = False
        visited = [[0] * N for _ in range(N)]
        for i in range(N):
            for j in range(N):
                bfs(i, j)
        for v in V:
            p = v.pop()
            for ij in v:
                arr[ij[0]][ij[1]] = p
    print(arr)
    print(result)
